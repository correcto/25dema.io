<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <title>Maria e Tiago - 25 de maio</title>
  </head>
  <body>
    <header>
      <div class="hamburger">☰</div>
      <div class="header-text">25DEMAIO</div>
      <nav>
        <a href="#Convite" class="menu-item">25 de maio</a>
        <a href="#Informacoesuteis" class="menu-item">Como chegar</a>
        <a href="#confpres" class="menu-item">Confirmar presença</a>
        <a href="#gift" class="menu-item">Lista de casamento</a>
      </nav>
    </header>
    <div class="overlay"></div>

    <section id="Convite">
      <h2>Vamos casar!</h2>
      <img src="assets/images/wedding_photo.jpeg" alt="Fotografia" />
      <p>
        Querida Família e Amigos,<br />
        Estamos muito felizes com este dia que se aproxima e esperamos poder
        contar com todos para celebrarmos juntos!
      </p>
      <p>
        Vamos casar dia
        <b>25 de maio às 16h na Igreja Nossa Senhora da Piedade da Merceana</b>
        , seguindo-se a festa na Quinta dos Plátanos.
      </p>
    </section>

    <section id="Informacoesuteis">
      <h2>Como chegar</h2>

      <div class="local-container">
        <div class="local">
          <p>CASAMENTO</p>

          <img
            src="assets/images/igreja.png"
            alt="Igreja Nossa Senhora da Piedade"
          />

          <p>
            <b>Igreja Nossa Senhora da Piedade da Merceana</b><br />Largo Rainha
            Dona Leonor 8, 2580-087 Merceana<br />
            <a
              href="https://maps.app.goo.gl/MAK2X4Uqcm3uLyWt9"
              target="_blank"
              rel="noopener"
              >(mapa)</a
            >
          </p>
        </div>
        <div class="local">
          <p>FESTA</p>

          <img src="assets/images/quinta.jpeg" alt="Quinta dos Plátanos" />

          <p>
            <b>Quinta dos Plátanos</b><br />N115 38, 2580-087 Merceana<br />
            <a
              href="https://maps.app.goo.gl/nPEzDjizdw5ERxpQ7"
              target="_blank"
              rel="noopener"
              >(mapa)</a
            >
          </p>
        </div>
      </div>
  
      <div class="subsecao">
        <p>DRESS CODE<br />
        Fato Escuro</p>
      </div>
    </section>

    <section id="confpres">
      <h2>Esperamos contar com Todos</h2>
      <p>Pedimos que confirmem a presença</p>
      <form id="confiii">
        <p>
          <label for="name">Nome:</label>
          <input
            type="text"
            id="name"
            name="name"
            class="nome-input"
            required
          />
        </p>

        <p>
          <label for="attendance">Confirma a presença?</label>
          <select
            id="attendance"
            name="attendance"
            class="select-input"
            required
          >
            <option value="">Selecione uma opção</option>
            <option value="yes">Sim</option>
            <option value="no">Não</option>
          </select>
        </p>
        <p id="foodRestrictionP">
          <label for="foodRestriction">Tem alguma restrição alimentar?</label>
          <select
            id="foodRestriction"
            name="foodRestriction"
            class="select-input"
          >
            <option value="">Selecione uma opção</option>
            <option value="no">Não</option>
            <option value="yes">Sim</option>
          </select>
        </p>

        <p id="foodDetails">
          <label for="foodDetailsText">Restrições:</label>
          <textarea
            id="foodDetailsText"
            name="foodDetailsText"
            class="mensagem-input"
          ></textarea>
        </p>

        <p>
          <label for="Msg">Mensagem:</label>
          <textarea id="Msg" name="Msg" class="mensagem-input"></textarea>
        </p>

        <p>
          <button type="submit" id="submitButton">ENVIAR RSVP</button>
        </p>
      </form>
    </section>

    <section id="gift">
      <h2>Lista de casamento</h2>

      <p>
        Deixamos aqui uma lista de presentes para a nossa casa, onde esperamos
        receber-vos. Também gostávamos muito de começar esta nova fase da nossa
        vida com uma viagem a São Tomé e Príncipe.
      </p>
      <p>
        Para nos oferecer um presente para a nossa casa ou contribuir para a nossa
        lua de mel, escolha uma das opções:<br />
      </p>

      <!-- Caixa 2 -->
      <a
        href="pages/gift/index.html?presente=Contribuição%20para%20a%20lua%20de%20mel"
        class="caixa"
      >
        <h3>LUA DE MEL</h3>
      </a>

      <!-- Caixa 1 -->
      <a href="pages/servico/index.html" class="caixa">
        <h3>CASA</h3>
      </a>

      <p></p>
      <p><br /><br />Muito obrigado!<br /></p>
      <p></p>
    </section>
    <footer>
      <p>&copy; 2024, 25demaio - Todos os direitos reservados</p>
    </footer>

    <!-- Popup Alerta -->
    <div id="popupAlerta" class="popup-escondido">
      <div class="popup-conteudo">
        <span class="popup-fechar">&times;</span>
        <p id="popupMensagem">Mensagem de alerta aqui!</p>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        let nav = document.querySelector('nav');
        let overlay = document.querySelector('.overlay');

        // Toggle menu and overlay
        function toggleMenu() {
          if (window.innerWidth <= 768) {
            nav.classList.toggle('active');
            overlay.classList.toggle('visible');
          }
        }

        // Close menu and overlay
        function closeMenu() {
          if (nav.classList.contains('active')) {
            nav.classList.remove('active');
            overlay.classList.remove('visible');
          }
        }

        // Hamburger icon click
        document
          .querySelector('.hamburger')
          .addEventListener('click', function (event) {
            event.stopPropagation();
            toggleMenu();
          });

        // Close menu when clicking outside
        document.body.addEventListener('click', function (event) {
          if (!event.target.closest('nav')) {
            closeMenu();
          }
        });

        // Navigation link click
        document.querySelectorAll('nav a').forEach((link) => {
          link.addEventListener('click', closeMenu);
        });

        // Subsection toggle
        document.querySelectorAll('.subsecao .toggle').forEach((button) => {
          button.addEventListener('click', function () {
            let content = this.parentElement.nextElementSibling;
            content.style.display =
              content.style.display === 'none' ? 'block' : 'none';
            this.textContent = content.style.display === 'block' ? '-' : '+';
          });
        });

        // Menu item selection
        const menuItems = document.querySelectorAll('.menu-item');
        menuItems.forEach((item) => {
          item.addEventListener('click', () => {
            menuItems.forEach((item) =>
              item.classList.remove('selected-section')
            );
            item.classList.add('selected-section');
          });
        });
      });

      $(document).ready(function () {
        $('#confiii').on('submit', function (e) {
          e.preventDefault();
          var originalButtonText = $('#submitButton').text(); // Guardar o texto original do botão

          $('#submitButton').text('A enviar...').prop('disabled', true); // Alterar texto e desabilitar botão para prevenir envios múltiplos

          var formData = $(this).serialize();

          $.ajax({
            type: 'POST',
            url: 'https://script.google.com/macros/s/AKfycbymqJ4pnzTlP7bqEcKRc1RnLnIuYTBRlt2izGyWLajzMTQiLEMzX3PiXMNRF-cNZqmO/exec',
            data: formData,
            success: function (response) {
              mostrarPopupAlerta('Resposta enviada, obrigado.', true);
              $('#submitButton')
                .text(originalButtonText)
                .prop('disabled', false); // Restaurar texto e habilitar botão
              $('#confiii')[0].reset();
            },

            error: function () {
              mostrarPopupAlerta(
                'Pedimos desculpa, mas houve um erro ao enviar sua resposta. Por favor, tente novamente.',
                false
              );
              $('#submitButton')
                .text(originalButtonText)
                .prop('disabled', false); // Em caso de erro, também restaurar
              $('#confiii')[0].reset();
            },
          });
        });

        // Fechar popup ao clicar em 'x'
        $('.popup-fechar').click(function () {
          $('#popupAlerta').hide();
        });

        // Função para mostrar o popup de alerta
        function mostrarPopupAlerta(mensagem, sucesso) {
          $('#popupMensagem').text(mensagem);
          $('#popupAlerta').show();
        }

        $(document).mouseup(function (e) {
          var popupConteudo = $('#popupAlerta .popup-conteudo'); // Seleciona o conteúdo interno do pop-up

          // Verifica se o clique foi fora do conteúdo do pop-up (no overlay)
          if (
            !popupConteudo.is(e.target) &&
            popupConteudo.has(e.target).length === 0
          ) {
            $('#popupAlerta').hide(); // Esconde o overlay e o pop-up
          }
        });

        // Lógica para mostrar/esconder detalhes das restrições alimentares
        $('#attendance').change(function () {
          if ($(this).val() === 'yes') {
            $('#foodRestrictionP').show();
            $('#foodRestriction').attr('required', true);
          } else {
            $('#foodRestrictionP').hide();
            $('#foodRestriction').removeAttr('required').val('');
            $('#foodDetails').hide().removeAttr('required').val(''); // Reset the textarea if foodRestriction is not 'yes'
          }
        });

        $('#foodRestriction').change(function () {
          if ($(this).val() === 'yes') {
            $('#foodDetails').show().attr('required', true);
          } else {
            $('#foodDetails').hide().removeAttr('required').val(''); // Reset the textarea if foodRestriction is not 'yes'
          }
        });
      });
    </script>
  </body>
</html>
